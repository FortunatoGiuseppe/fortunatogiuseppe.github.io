(globalThis["webpackChunktamponati_client"]=globalThis["webpackChunktamponati_client"]||[]).push([[463],{3245:(e,o,a)=>{"use strict";a.d(o,{Z:()=>l,e:()=>n});var t=a(4562);const l={id:null,nomecompleto:"",tipo:null,cf:"",provincia:"",nome:"",cognome:""},n=(0,t.r8)((()=>(0,t.y$)("vue-tamponati",{...l},sessionStorage)))},4463:(e,o,a)=>{"use strict";a.r(o),a.d(o,{default:()=>De});var t=a(3673),l=a(1175),n=a.n(l),i=a(7037),r=a.n(i),d=a(8596),u=a.n(d),s=a(2776),c=a.n(s);const m={class:"q-pa-md",style:{width:"100%"}},p={class:"full-width"},f={key:2},g=(0,t.Wm)("h1",null,"Datore di Lavoro",-1),v={key:4},b=(0,t.Wm)("h1",null,"TAMPONATI",-1),w=(0,t.Wm)("h2",null,"Prenota il tuo tampone presso i laboratori piu vicini a te",-1);function h(e,o,a,l,i,d){const s=(0,t.up)("q-carousel-slide"),h=(0,t.up)("q-carousel"),D=(0,t.up)("cittadino-home"),Z=(0,t.up)("medico-home"),_=(0,t.up)("laboratorio-home"),y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(y,{class:"flex flex-center"},{default:(0,t.w5)((()=>[(0,t.Wm)("div",m,[(0,t.Wm)(h,{modelValue:e.slide,"onUpdate:modelValue":o[1]||(o[1]=o=>e.slide=o),animated:"",navigation:"",infinite:"",autoplay:e.autoplay,arrows:"","transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:o[2]||(o[2]=o=>e.autoplay=!1),onMouseleave:o[3]||(o[3]=o=>e.autoplay=!0)},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{name:1,"img-src":n()}),(0,t.Wm)(s,{name:2,"img-src":r()}),(0,t.Wm)(s,{name:3,"img-src":u()}),(0,t.Wm)(s,{name:4,"img-src":c()})])),_:1},8,["modelValue","autoplay"])]),(0,t.Wm)("section",p,[e.state.tipo_utente&&1==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(D,{key:0})):e.state.tipo_utente&&2==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(Z,{key:1})):e.state.tipo_utente&&3==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)("div",f,[g])):e.state.tipo_utente&&4==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(_,{key:3})):((0,t.wg)(),(0,t.j4)("div",v,[b,w]))])])),_:1})}var D=a(1959),Z=a(1762),_=a(2490),y=a(3245);const W=(0,t.Wm)("h1",null,"Cittadino",-1);function Y(e,o,a,l,n,i){const r=(0,t.up)("q-btn"),d=(0,t.up)("q-page-sticky");return(0,t.wg)(),(0,t.j4)("div",null,[W,(0,t.Wm)(d,{position:"bottom-right",offset:[24,24]},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{fab:"",icon:"add",label:"Nuova Prenotazione",color:"primary",onClick:e.openPrenota},null,8,["onClick"])])),_:1})])}var P=a(8825),q=a(8880),V=a(2323);const k=(0,t.Wm)("div",{class:"text-h6"},"Prenota Tampone",-1);function C(e,o,a,l,n,i){const r=(0,t.up)("q-card-section"),d=(0,t.up)("q-separator"),u=(0,t.up)("q-input"),s=(0,t.up)("q-select"),c=(0,t.up)("q-item-label"),m=(0,t.up)("q-item-section"),p=(0,t.up)("q-item"),f=(0,t.up)("q-date"),g=(0,t.up)("q-btn"),v=(0,t.up)("q-card-actions"),b=(0,t.up)("q-form"),w=(0,t.up)("q-card"),h=(0,t.up)("q-dialog"),D=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(h,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"q-dialog-plugin",style:{"min-width":"455px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{onSubmit:(0,q.iM)(e.doPrenotazione,["prevent"])},{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[k])),_:1}),(0,t.Wm)(d),(0,t.Wm)(r,{class:"col q-gutter-md"},{default:(0,t.w5)((()=>[2==e.state.tipo_utente||3==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(u,{key:0,modelValue:e.register.nome,"onUpdate:modelValue":o[1]||(o[1]=o=>e.register.nome=o),outlined:"",label:"Nome",rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","rules"])):(0,t.kq)("",!0),2==e.state.tipo_utente||3==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(u,{key:1,modelValue:e.register.cognome,"onUpdate:modelValue":o[2]||(o[2]=o=>e.register.cognome=o),outlined:"",label:"Cognome",rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","rules"])):(0,t.kq)("",!0),2==e.state.tipo_utente||3==e.state.tipo_utente?((0,t.wg)(),(0,t.j4)(u,{key:2,modelValue:e.register.codicefiscale,"onUpdate:modelValue":o[3]||(o[3]=o=>e.register.codicefiscale=o),outlined:"",label:"Codice Fiscale",mask:"AAAAAA##A##A###A",rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","rules"])):(0,t.kq)("",!0),(0,t.Wm)(s,{modelValue:e.tipotampone,"onUpdate:modelValue":o[4]||(o[4]=o=>e.tipotampone=o),outlined:"",label:"Tipo di Tampone",options:e.options,rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","options","rules"]),(0,t.Wm)(s,{modelValue:e.provincia,"onUpdate:modelValue":o[5]||(o[5]=o=>e.provincia=o),outlined:"","emit-value":"","map-options":"",label:"Provincia",options:e.optionsProvince,rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","options","rules"]),(0,t.Wm)(s,{modelValue:e.id_laboratorio,"onUpdate:modelValue":o[6]||(o[6]=o=>e.id_laboratorio=o),outlined:"",label:"Laboratorio","option-value":"uid","option-label":"nome","emit-value":"","map-options":"",options:e.optionsLaboratori,rules:[e=>!!e||"Campo Richiesto"],onFilter:e.getLabs},{option:(0,t.w5)((e=>[(0,t.Wm)(p,e.itemProps,{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(e.opt.nome),1)])),_:2},1024),(0,t.Wm)(c,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(e.opt.citta)+" ("+(0,V.zw)(e.opt.provincia)+")",1)])),_:2},1024),(0,t.Wm)(c,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(e.opt.indirizzo),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","rules","onFilter"]),(0,t.Wm)(f,{modelValue:e.data,"onUpdate:modelValue":o[7]||(o[7]=o=>e.data=o),landscape:"",options:e.dateDispo},null,8,["modelValue","options"])])),_:1}),(0,t.Wm)(d),(0,t.Wm)(v,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(g,{label:"Annulla",color:"grey",flat:""},null,512),[[D]]),(0,t.Wm)(g,{type:"submit",color:"primary",label:"Prenota",flat:""})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["onHide"])}var M=a(1701),Q=a(5616),x=a(5720);const H=(0,t.aZ)({name:"PrenotaTampone",props:{id:{type:String,default:null}},emits:[...M.Z.emits],setup(){const{dialogRef:e,onDialogOK:o,onDialogHide:a}=(0,M.Z)(),l=(0,P.Z)(),n=(0,y.e)(),i=(0,D.iH)(""),r=(0,D.iH)(""),d=(0,D.iH)(""),u=(0,D.iH)(""),s=(0,D.iH)({}),c=(0,D.iH)([]);_.db.collection("province").get().then((e=>{e.forEach((e=>{c.value.push(e.data())}))})),(0,t.YP)(r,(()=>{m.value=[],f.value=[],d.value="",u.value=""}));const m=(0,D.iH)([]),p=(e,o,a)=>{r.value.length<2?a():_.db.collection("users").where("tipo_utente","==",4).where("provincia","==",r.value).get().then((e=>{o((()=>{m.value=[],e.forEach((e=>{m.value.push(e.data())}))}))}))},f=(0,D.iH)([]);(0,t.YP)(d,(async()=>{f.value=[],_.db.collection("calendari").where("id_laboratorio","==",d.value).where("data",">=",x.Z.firestore.Timestamp.fromDate(Q.ZP.startOfDate(new Date,"day"))).get().then((e=>{e.forEach((e=>{f.value.push(Q.ZP.formatDate(e.data().data.toDate(),"YYYY/MM/DD"))}))})).catch((e=>{console.log(e),f.value=[]}))}));const g=async()=>{if(!u.value||u.value.length<4)l.notify({type:"negative",position:"top",message:"Selezionare una data!"});else try{1==n.value.tipo_utente?await _.db.collection("prenotazioni").add({prenotatoda:n.value.id,tipotampone:i.value,id_laboratorio:d.value,data:x.Z.firestore.Timestamp.fromDate(Q.ZP.extractDate(u.value,"YYYY/MM/DD")),nome:n.value.nome,cognome:n.value.cognome,codicefiscale:n.value.cf,confermato:0,esito:null}):await _.db.collection("prenotazioni").add({prenotatoda:n.value.id,tipotampone:i.value,id_laboratorio:d.value,data:x.Z.firestore.Timestamp.fromDate(Q.ZP.extractDate(u.value,"YYYY/MM/DD")),nome:s.value.nome,cognome:s.value.cognome,codicefiscale:s.value.codicefiscale,confermato:0,esito:null}),o()}catch(e){l.notify({type:"negative",position:"top",message:"Errore salvataggio Dati!"}),console.log(e)}};return{dateDispo:f,dialogRef:e,onDialogOK:o,onDialogHide:a,options:["Molecolare","Antigenico"],optionsProvince:c,optionsLaboratori:m,getLabs:p,tipotampone:i,provincia:r,id_laboratorio:d,data:u,doPrenotazione:g,register:s,state:n}}});var T=a(5926),U=a(151),z=a(8689),j=a(5589),A=a(5869),S=a(4842),R=a(3314),E=a(3414),L=a(2035),I=a(2350),N=a(6915),O=a(9367),F=a(8240),B=a(677),K=a(7518),G=a.n(K);H.render=C;const $=H;G()(H,"components",{QDialog:T.Z,QCard:U.Z,QForm:z.Z,QCardSection:j.Z,QSeparator:A.Z,QInput:S.Z,QSelect:R.Z,QItem:E.Z,QItemSection:L.Z,QItemLabel:I.Z,QDate:N.Z,QCardActions:O.Z,QBtn:F.Z}),G()(H,"directives",{ClosePopup:B.Z});const J=(0,t.aZ)({name:"CittadinoHome",setup(){const e=(0,P.Z)(),o=()=>{e.dialog({component:$}).onOk((async e=>{}))};return{openPrenota:o}}});var X=a(4264);J.render=Y;const ee=J;G()(J,"components",{QPageSticky:X.Z,QBtn:F.Z});const oe=(0,t.Wm)("p",{class:"text-center text-h5"},"Laboratorio",-1),ae={class:"q-pa-md"},te={class:"q-pa-md"};function le(e,o,a,l,n,i){const r=(0,t.up)("q-input"),d=(0,t.up)("q-popup-edit"),u=(0,t.up)("q-td"),s=(0,t.up)("q-checkbox"),c=(0,t.up)("q-table"),m=(0,t.up)("q-option-group"),p=(0,t.up)("q-btn"),f=(0,t.up)("q-page-sticky");return(0,t.wg)(),(0,t.j4)("div",null,[oe,(0,t.Wm)("div",ae,[(0,t.Wm)(c,{title:"Da Confermare",rows:e.daConfermare,columns:e.colConfermare,pagination:{page:1,daConfermarePerPage:0},"row-key":"id","binary-state-sort":"","hide-bottom":"",bordered:"",flat:""},{"body-cell-data":(0,t.w5)((o=>[(0,t.Wm)(u,{props:o},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(o.row.data)+" ",1),(0,t.Wm)(d,{modelValue:o.row.data,"onUpdate:modelValue":e=>o.row.data=e,"auto-save":"",onSave:a=>e.updateDataTampone(a,o.row)},{default:(0,t.w5)((e=>[(0,t.Wm)(r,{modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,mask:"##/##/####",dense:"",autofocus:"",onKeyup:(0,q.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])])),_:2},1032,["props"])])),"body-cell-confermato":(0,t.w5)((o=>[(0,t.Wm)(u,{props:o},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:o.row.confermato,"onUpdate:modelValue":[e=>o.row.confermato=e,a=>e.confermaTampone(o.row)]},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"])]),(0,t.Wm)("div",te,[(0,t.Wm)(c,{title:"Da Refertare",rows:e.daRefertare,columns:e.colRefertare,pagination:{page:1,daConfermarePerPage:0},"row-key":"id","binary-state-sort":"","hide-bottom":"",bordered:"",flat:""},{"body-cell-esito":(0,t.w5)((o=>[(0,t.Wm)(u,{props:o},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:o.row.confermato,"onUpdate:modelValue":[e=>o.row.confermato=e,a=>e.updateEsitoTampone(a,o.row)],options:e.optionsEsito},null,8,["modelValue","onUpdate:modelValue","options"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"])]),(0,t.Wm)(f,{position:"bottom-right",offset:[24,24]},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{fab:"",icon:"date_range",label:"Calendario",to:"/calendario",color:"primary"})])),_:1})])}const ne=(0,t.aZ)({name:"LaboratorioHome",setup(){const e=(0,y.e)(),o=[{label:"Positivo",value:!0},{label:"Negativo",value:!1}],a=[{name:"data",label:"Data",field:"data",align:"left",sortable:!0,sort:(e,o)=>Q.ZP.extractDate(e,"DD/MM/YYYY")-Q.ZP.extractDate(o,"DD/MM/YYYY")},{name:"codicefiscale",label:"Cod. Fiscale",field:"codicefiscale",align:"left",sortable:!0},{name:"nome",label:"Nome",field:"nome",align:"left",sortable:!0},{name:"cognome",label:"Cognome",field:"cognome",align:"left",sortable:!0},{name:"confermato",label:"Conferma",field:"confermato",align:"left"}],t=[{name:"data",label:"Data",field:"data",align:"left",sortable:!0,sort:(e,o)=>Q.ZP.extractDate(e,"DD/MM/YYYY")-Q.ZP.extractDate(o,"DD/MM/YYYY")},{name:"codicefiscale",label:"Cod. Fiscale",field:"codicefiscale",align:"left",sortable:!0},{name:"nome",label:"Nome",field:"nome",align:"left",sortable:!0},{name:"cognome",label:"Cognome",field:"cognome",align:"left",sortable:!0},{name:"esito",label:"Esito",field:"esito",align:"left"}],l=(0,D.iH)([]);_.db.collection("prenotazioni").where("id_laboratorio","==",e.value.id).where("confermato","==",0).orderBy("data","asc").get().then((e=>{e.forEach((e=>{const{nome:o,cognome:a,codicefiscale:t}=e.data();l.value.push({id:e.id,data:Q.ZP.formatDate(e.data().data.toDate(),"DD/MM/YYYY"),codicefiscale:t,nome:o,cognome:a,confermato:!1,esito:null})}))}));const n=(0,D.iH)([]);_.db.collection("prenotazioni").where("id_laboratorio","==",e.value.id).where("confermato","==",1).get().then((e=>{e.forEach((e=>{const{nome:o,cognome:a,codicefiscale:t,esito:l}=e.data();n.value.push({id:e.id,data:Q.ZP.formatDate(e.data().data.toDate(),"DD/MM/YYYY"),codicefiscale:t,nome:o,cognome:a,confermato:!0,esito:l})}))}));const i=async o=>{await _.db.collection("prenotazioni").doc(o.id).update({confermato:1});const a=await _.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data","==",x.Z.firestore.Timestamp.fromDate(Q.ZP.extractDate(o.data,"DD/MM/YYYY"))).get();a.forEach((e=>{_.db.collection("calendari").doc(e.id).update({qta_disponibile:(e.data().qta_disponibile?e.data().qta_disponibile:e.data().qta)-1})}));const t=l.value.findIndex((e=>e.id===o.id));-1!==t&&(l.value.splice(t,1),n.value.push(o))},r=async(e,o)=>{await _.db.collection("prenotazioni").doc(o.id).update({esito:e});const a=l.value.findIndex((e=>e.id===o.id));-1!==a&&(l.value.splice(a,1),n.value.push(o))},d=async(e,o)=>{try{await _.db.collection("prenotazioni").doc(o.id).update({data:x.Z.firestore.Timestamp.fromDate(Q.ZP.extractDate(e,"DD/MM/YYYY"))})}catch(a){console.log(a)}};return{updateEsitoTampone:r,optionsEsito:o,colConfermare:a,colRefertare:t,daConfermare:l,daRefertare:n,confermaTampone:i,updateDataTampone:d}}});var ie=a(1993),re=a(3884),de=a(1289),ue=a(5735),se=a(8758);ne.render=le;const ce=ne;G()(ne,"components",{QTable:ie.Z,QTd:re.Z,QPopupEdit:de.Z,QInput:S.Z,QCheckbox:ue.Z,QOptionGroup:se.Z,QPageSticky:X.Z,QBtn:F.Z});const me=(0,t.Wm)("h1",null,"Medico",-1);function pe(e,o,a,l,n,i){const r=(0,t.up)("q-btn"),d=(0,t.up)("q-page-sticky");return(0,t.wg)(),(0,t.j4)("div",null,[me,(0,t.Wm)(d,{position:"bottom-right",offset:[24,24]},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{fab:"",icon:"add",label:"Nuova Prenotazione",color:"primary",onClick:e.openPrenota},null,8,["onClick"])])),_:1})])}const fe=(0,t.aZ)({name:"MedicoHome",setup(){const e=(0,P.Z)(),o=()=>{e.dialog({component:$}).onOk((async e=>{}))};return{openPrenota:o}}});fe.render=pe;const ge=fe;G()(fe,"components",{QPageSticky:X.Z,QBtn:F.Z});const ve=(0,t.aZ)({name:"PageIndex",components:{CittadinoHome:ee,LaboratorioHome:ce,MedicoHome:ge},setup(){const{isAuthenticated:e,user:o}=(0,Z.a)(_.auth),a=(0,y.e)();return(0,t.m0)((()=>{e.value&&o.value&&o.value.uid&&_.db.collection("users").doc(o.value.uid).get().then((e=>{if(e.exists){const t=e.data();a.value.id=o.value.uid,a.value.nome=t.nome,t.tipo_utente>2?a.value.nomecompleto=t.nome:(a.value.nomecompleto=t.nome+" "+t.cognome,a.value.cognome=t.cognome,a.value.cf=t.codicefiscale),a.value.tipo_utente=t.tipo_utente}}))})),{state:a,slide:(0,D.iH)(1),autoplay:(0,D.iH)(!0)}}});var be=a(4379),we=a(1277),he=a(4593);ve.render=h;const De=ve;G()(ve,"components",{QPage:be.Z,QCarousel:we.Z,QCarouselSlide:he.Z})},1175:(e,o,a)=>{e.exports=a.p+"img/carousel1.8d5db68e.jpg"},7037:(e,o,a)=>{e.exports=a.p+"img/carousel2.33052859.jpg"},8596:(e,o,a)=>{e.exports=a.p+"img/carousel3.d24cf387.jpg"},2776:(e,o,a)=>{e.exports=a.p+"img/carousel4.5141b06e.jpg"}}]);