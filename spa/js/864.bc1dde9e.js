(globalThis["webpackChunktamponati_client"]=globalThis["webpackChunktamponati_client"]||[]).push([[864],{3245:(e,a,t)=>{"use strict";t.d(a,{Z:()=>o,e:()=>d});var l=t(4562);const o={id:null,nomecompleto:"",tipo:null,cf:"",provincia:"",nome:"",cognome:""},d=(0,l.r8)((()=>(0,l.y$)("vue-tamponati",{...o},sessionStorage)))},3864:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var l=t(3673),o=t(8880),d=t(2323);const u={class:"q-pa-md"},r=(0,l.Uk)("Data"),n=(0,l.Uk)("Q.ta Tamponi"),i=(0,l.Uk)("Action");function s(e,a,t,s,m,c){const p=(0,l.up)("q-date"),f=(0,l.up)("q-popup-proxy"),w=(0,l.up)("q-icon"),D=(0,l.up)("q-input"),Y=(0,l.up)("q-item-label"),v=(0,l.up)("q-item-section"),_=(0,l.up)("q-btn"),W=(0,l.up)("q-item"),b=(0,l.up)("q-list"),q=(0,l.up)("q-form"),Z=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)("div",u,[(0,l.Wm)(q,{ref:"formRef",onSubmit:(0,o.iM)(e.addRow,["prevent"])},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"rounded-borders q-my-md",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"items-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{modelValue:e.register.data,"onUpdate:modelValue":a[3]||(a[3]=a=>e.register.data=a),outlined:"",label:"Data",dense:"",mask:"##/##/####",rules:[e=>/^-?[0-3]\d\/[0-1]\d\/[\d]+$/.test(e)||"Campo Richiesto",a=>e.checkMajToday(a)||"La Data non deve essere nel passato"]},{append:(0,l.w5)((()=>[(0,l.Wm)(w,{name:"event",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{ref:"qDateProxy"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:e.register.data,"onUpdate:modelValue":[a[1]||(a[1]=a=>e.register.data=a),a[2]||(a[2]=()=>e.$refs.qDateProxy.hide())],mask:"DD/MM/YYYY",options:e.limitDateFn},null,8,["modelValue","options"])])),_:1},512)])),_:1})])),_:1},8,["modelValue","rules"])])),_:1})])),_:1}),(0,l.Wm)(v,{class:"text-weight-medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"qtaRef",modelValue:e.register.qta,"onUpdate:modelValue":a[4]||(a[4]=a=>e.register.qta=a),modelModifiers:{number:!0},outlined:"",label:"QuantitÃ ",dense:"",rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","rules"])])),_:1})])),_:1}),(0,l.Wm)(v,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,{class:"text-black"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{type:"submit",icon:"add",flat:"",round:"",color:"primary"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"]),(0,l.Wm)(b,{class:"rounded-borders relative-position",bordered:"",separator:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"text-weight-medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[r])),_:1})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[n])),_:1})])),_:1}),(0,l.Wm)(v,{class:"col-2 text-black",side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[i])),_:1})])),_:1})])),_:1}),(0,l.Wm)(o.W3,{name:"scale","move-class":"move-transition"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(e.sortedCalendar,((a,t)=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(W,{key:t,clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(a.data),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(a.qta),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(v,{class:"col-2 text-black",side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{icon:"delete",flat:"",onClick:t=>e.deleteRow(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[Z]]))),128))])),_:1})])),_:1})])}var m=t(1959),c=t(5720),p=t(5616),f=t(2490),w=t(3245);const D=(0,l.aZ)({name:"PrenotaTamponePage",setup(){const e=(0,w.e)(),a=(0,m.iH)(null),t=(0,m.iH)(null),o=(0,m.iH)([]),d=(0,m.iH)({data:"",qta:""});f.db.collection("calendari").where("id_laboratorio","==",e.value.id).get().then((e=>{const a=[];e.forEach((e=>{a.push({data:p.ZP.formatDate(e.data().data.toDate(),"DD/MM/YYYY"),qta:e.data().qta})})),o.value=a}));const u=p.ZP.formatDate(Date.now(),"YYYY/MM/DD"),r=e=>e>=u,n=e=>p.ZP.extractDate(e,"DD/MM/YYYY")>=new Date,i=e=>o.value.findIndex((a=>a.data===e)),s=async()=>{const u=i(d.value.data);if(-1!==u){o.value[u].qta=d.value.qta;const a=await f.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data","==",c.Z.firestore.Timestamp.fromDate(p.ZP.extractDate(d.value.data,"DD/MM/YYYY"))).get();a.forEach((e=>{f.db.collection("calendari").doc(e.id).update({qta:d.value.qta})}))}else o.value.push({...d.value}),await f.db.collection("calendari").add({id_laboratorio:e.value.id,data:c.Z.firestore.Timestamp.fromDate(p.ZP.extractDate(d.value.data,"DD/MM/YYYY")),qta:parseInt(d.value.qta)});d.value.data=p.ZP.formatDate(p.ZP.addToDate(p.ZP.extractDate(d.value.data,"DD/MM/YYYY"),{days:1}),"DD/MM/YYYY"),d.value.qta="",await(0,l.Y3)(),a.value.resetValidation(),t.value.focus()},D=a=>{const t=i(a.data);f.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data","==",c.Z.firestore.Timestamp.fromDate(p.ZP.extractDate(a.data,"DD/MM/YYYY"))).get().then((e=>{e.forEach((e=>{f.db.collection("calendari").doc(e.id).delete()}))})),o.value.splice(t,1)},Y=(0,l.Fl)((()=>{const e=[...o.value];return e.sort(((e,a)=>p.ZP.extractDate(e.data,"DD/MM/YYYY")-p.ZP.extractDate(a.data,"DD/MM/YYYY"))),e}));return{formRef:a,qtaRef:t,limitDateFn:r,checkMajToday:n,register:d,sortedCalendar:Y,addRow:s,deleteRow:D}}});var Y=t(8689),v=t(7011),_=t(3414),W=t(2035),b=t(2350),q=t(4842),Z=t(4554),M=t(3944),h=t(6915),g=t(8240),k=t(6489),x=t(7518),P=t.n(x);D.render=s;const y=D;P()(D,"components",{QForm:Y.Z,QList:v.Z,QItem:_.Z,QItemSection:W.Z,QItemLabel:b.Z,QInput:q.Z,QIcon:Z.Z,QPopupProxy:M.Z,QDate:h.Z,QBtn:g.Z}),P()(D,"directives",{Ripple:k.Z})}}]);